[{"title":"Docker环境下部署MySQL + Redis + PhpMyAdmin","path":"/d97d6cf71fd7/","content":"Compose 项目是 Docker 官方的开源项目，负责实现对 Docker 容器集群的快速编排。使用前面介绍的Dockerfile我们很容易定义一个单独的应用容器。然而在日常开发工作中，经常会碰到需要多个容器相互配合来完成某项任务的情况。例如要实现一个 Web 项目，除了 Web 服务容器本身，往往还需要再加上后端的数据库服务容器；再比如在分布式应用一般包含若干个服务，每个服务一般都会部署多个实例。如果每个服务都要手动启停，那么效率之低、维护量之大可想而知。这时候就需要一个工具能够管理一组相关联的的应用容器，这就是Docker Compose。 本次的版本是：mysql:5.7redis:7.0phpmyadmin:latest 最好还是先Pull镜像 1docker pull mysql:5.7 1docker pull redis:7.0 1docker pull phpmyadmin/phpmyadmin:latest vim docker-compose.yaml 复制yaml格式的配置文件修改 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849version: &#x27;3.8&#x27;services: mysql: image: mysql:5.7 container_name: mysql command: --lower_case_table_names=1 --default-authentication-plugin=mysql_native_password #这行代码解决无法访问的问题 # ALTER USER&#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;; restart: always environment: MYSQL_ROOT_PASSWORD: password # 修改这里的密码 MYSQL_DATABASE: dbname # 如果需要预创建数据库，指定数据库名 MYSQL_USER: dbuser # 可选，新建一个用户 MYSQL_PASSWORD: dbpasswd # 用户密码 ports: - &quot;3306:3306&quot; volumes: - mysql_data:/var/lib/mysql redis: image: redis:7.0 container_name: redis restart: always ports: - &quot;6379:6379&quot; environment: - TZ=Asia/Shanghai - LANG=en_US.UTF-8 volumes: - redis_data:/data phpmyadmin: image: phpmyadmin/phpmyadmin:latest container_name: phpmyadmin restart: always environment: PMA_HOST: mysql PMA_PORT: 3306 MYSQL_ROOT_PASSWORD: password # 和MySQL root用户密码保持一致 depends_on: - mysql ports: - &quot;8888:80&quot;volumes: mysql_data: redis_data: 使用Portainer-CE，直接部署就行 在bash 中，在docker-compose.yaml 目录中 执行 1docker-compose up -d","tags":["docker","mysql"]},{"title":"使用 Vercel 反代 Openai","path":"/e8ae4aaeef2f/","content":"https://YOUR DOMAIN（改成你的域名）&#x2F;v1&#x2F;chat&#x2F;completions GitHub地址： 点击一键部署按钮 用 Github 登录 Vercel，没有 Github 账户的去注册一个 登录之后点击 Create 按钮 接着等十几秒钟就创建好项目了，接下来进入仪表盘 进入到项目里之后，依次点击 Settings -&gt; Domains，然后添加你的域名。添加的域名类型有两种，一种是一级域名(xxxx.com)和二级域名(openai.xxxx.com)，推荐使用二级域名，因为一级域名一般用来做网站展示用，只能有一个，而二级域名可以有无限个（只要你有一个域名就可以自己创建无限个二级域名） 二级域名（以 openai 主机记录为例，可以改成自己喜欢的） 添加二级域名后 Vercel 会提示让你添加 DNS 解析记录 在域名解析的解析设置里点击 添加记录，按照 Vercel 的提示配置好图中三个选项，点击确认 回 Vercel 点击 Refresh 按钮，出现https申请成功所示的情况就表明配置完成了 🎉接下来就可以愉快地使用 openai api 啦~","tags":["OpenAi","Vercel"]},{"title":"安装SafeLine Web 安全网关","path":"/36d1b72d6cde/","content":"这是一个自带安全 buf 的 Nginx，它基于业界领先的语义分析检测技术开发，作为反向代理接入，保护你的网站不受黑客攻击。 GitHub地址： SafeLine 官网提供了多种部署方案，最简单的是一键安装方案，执行以下命令。 🚀 安装配置需求 操作系统：Linux 指令架构：x86_64 软件依赖：Docker 20.10.6 版本以上 软件依赖：Docker Compose 2.0.0 版本以上 最小化环境：1 核 CPU &#x2F; 1 GB 内存 &#x2F; 10 GB 磁盘 1bash -c &quot;$(curl -fsSLk https://waf-ce.chaitin.cn/release/latest/setup.sh)&quot; 其他安装方式： 123git clone https://github.com/chaitin/SafeLine.gitcd SafeLinebash ./release/latest/setup.sh 登录浏览器打开后台管理页面 https://&lt;waf-ip&gt;:9443。根据界面提示，使用 支持 TOTP 的认证软件 扫描二维码，然后输入动态口令登录： 配置防护站点雷池以反向代理方式接入，优先于网站服务器接收流量，对流量中的攻击行为进行检测和清洗，将清洗过后的流量转发给网站服务器。 💡 TIPS: 添加后，执行 curl -H &quot;Host: &lt;域名&gt;&quot; http://&lt;WAF IP&gt;:&lt;端口&gt; 应能获取到业务网站的响应。 测试效果使用以下方式尝试模拟黑客攻击，看看雷池的防护效果如何 浏览器访问 http://&lt;IP或域名&gt;:&lt;端口&gt;/?id=1%20AND%201=1 浏览器访问 http://&lt;IP或域名&gt;:&lt;端口&gt;/?a=&lt;script&gt;alert(1)&lt;/script&gt; 如果你需要进行深度测试，请参考 测试防护效果","tags":["docker","安全网关","nginx"]},{"title":"安装Code-server使用并配置https","path":"/11235da5e10d/","content":"在自己的局域网服务器上安装了code-server，但是markdown预览无法正常显示。查了一下，需要在https加密模式下才能在浏览器中正常使用功能。 自己的服务器是用WireGuard在虚拟局域网内连接，没有公网ip和域名， 最后用的是本地签名证书。 I 安装&amp;启动GitHub地址： 安装命令 现在你有两种方式来启动 code-server： 先手动启动生成默认配置文件 手动启动：如果你不希望 code-server 作为后台服务运行，你可以手动启动它： 1code-server 作为系统服务启动：这将使 code-server 在后台运行，并在开机时自动启动。只需执行以下命令： 1sudo systemctl enable --now code-server@root 在这里，$USER 是环境变量，表示当前用户名。如果你想要以其他用户身份运行 code-server，你需要将 $USER 替换为相应的用户名。 一旦 code-server 启动，你就可以通过 http://localhost:8080 （默认端口是 8080）在你的浏览器中访问它了。如果你在远程服务器上安装了 code-server，你需要替换 localhost 为你服务器的公网 IP 地址或域名，并确保防火墙设置允许流量通过 8080 端口。 首次访问 code-server 时，你会被要求输入一个密码。这个密码是为了保护你的 code-server 实例不被未授权访问。你可以在启动 code-server 时通过 --auth 选项设置密码，或者在 ~/.config/code-server/config.yaml 文件中进行配置。 查看配置文件： 1cat ~/.config/code-server/config.yaml password 字段的密码是随机生成的，你可以自己修改 改动配置文件（vim）： 1vim ~/.config/code-server/config.yaml 修改 bind-addr 字段的IP为 本地局域网ip 重启Code-Server 服务 1sudo systemctl restart code-server@root 然后在同一局域网下访问host地址，输入密码即可。 此时是http，没有加载证书 II 配置本地https使用mkcert 生成相应网址的证书: 示例 本地地址为192.168.1.223 1234# $ mkcert [website addr] 192.168.1.223为服务器的内网网址# -cert-file [filename] 生成对应crt文件的名称# -cert-key [filename] 生成对应key文件的名称$ mkcert -cert-file phone-code-server.crt -key-file phone-code-server.key 192.168.1.223 127.0.0.1 在&#x2F;root&#x2F;.local&#x2F;share&#x2F;code-server&#x2F;下创建cert文件夹 1mkdir ~/.local/share/code-server/cert 复制刚刚生成的证书文件到~&#x2F;.local&#x2F;share&#x2F;code-server&#x2F;cert目录 12cp /root/phone-code-server.key ~/.local/share/code-server/cert/cp /root/phone-code-server.crt ~/.local/share/code-server/cert/ 再次改动配置文件（vim）： 1vim ~/.config/code-server/config.yaml 如下 修改证书位置，刚刚证书文件已经复制过去了 12345bind-addr: 192.168.1.223:8080auth: passwordpassword: df90f81c4355ffe98172dbe1cert: /root/.local/share/code-server/cert/phone-code-server.crtcert-key: /root/.local/share/code-server/cert/phone-code-server.key 重启Code-Server 服务 1sudo systemctl restart code-server@root 因为是本地证书，所以我们要把证书导出，再安装到访问客户端才可以 12345mkcert -installmkcert -CAROOTcd /home/cp /root/.local/share/mkcert/rootCA.pem /home/ #将证书复制到home目录 方便一会导出mv rootCA.pem rootCA.crt #重命名为crt，方便Windows导入 现在登陆 code-server web 选择资源管理器 选择”open folder” 切换到home目录 信任 选择刚刚重命名的证书文件 点击下载 Windows 安装，受信任的根证书 导入完成后，重新打开浏览器，打开code-server,可以看到已经生效了https 重新登陆后可以到拓展市场，安装简体中文包 选择菜单，终端，使用很方便！！！ 完成","tags":["linux","Code Server","https"]},{"title":"docker 一键安装命令","path":"/0ee259ad053c/","content":"docker的一键安装指令（脚本目前好像只能适用于Ubuntu和Debian，centos也可以） 1.官方给的命令（推荐） 1curl -sSL https://get.docker.com/ | sh 2.DaoCloud的（国内DaoCloud的快一些） 1curl -sSL https://get.daocloud.io/docker | sh","tags":["docker","Linux"]},{"title":"部署Docker管理工具 Portainer-CE 社区","path":"/3ab5f2264bd0/","content":"Portainer是一款开源的容器管理平台，它提供了一个直观易用的Web界面，帮助用户管理Docker容器集群、镜像、卷等资源。Portainer 支持多种 Docker 环境，包括本地Docker、Swarm 模式、Kubernetes 等，并支持多租户、RBAC权限管理等功能。 使用 Portainer，可以方便地创建、启动、停止、删除容器，管理容器的网络、卷、环境变量等设置，查看容器日志、统计信息等。此外，Portainer 还提供了一些实用的功能，如容器模板、自定义仪表盘、事件监控、Web 终端等。 GitHub地址： Docker Hub 地址：https://hub.docker.com/r/6053537/portainer-ce 一键安装代码 1docker run -d --restart=always --name=&quot;portainer&quot; -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock 6053537/portainer-ce 访问hub.docker.com网络慢,可以尝试下面的方式 12docker pull hub-mirror.c.163.com/6053537/portainer-cedocker run -d --restart=always --name=&quot;portainer&quot; -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data 6053537/portainer-ce 如果你要启用ssl访问，远程主机建议启用，端口443和证书路径&#x2F;certs请自行更改 123docker run -d -p 443:9000 --name portainer --restart always -v ~/local-certs:/certs -v portainer_data:/data 6053537/portainer-ce -v /var/run/docker.sock:/var/run/docker.sock --ssl --sslcert /certs/portainer.crt --sslkey /certs/portainer.key","tags":["docker","Portainer-CE"]},{"title":"我们奔跑在曲折的时空，过去与未来发生交折。","path":"/5640feae4a65/","content":""},{"title":"修正ubuntu的时区和时间","path":"/fed1903aae45/","content":"查看当前系统时间 1date 这个命令会将系统时区设置为 Asia&#x2F;Shanghai，它对应于中国大陆的标准时间，即东八区 1sudo timedatectl set-timezone Asia/Shanghai 可以用以下命令确认时区设置是否成功： 1timedatectl 手动强制一次时间同步，可以使用 timedatectl 命令： 12sudo timedatectl set-ntp offsudo timedatectl set-ntp on","tags":["linux"]},{"title":"关于","path":"/about/index.html","content":""},{"path":"/friends/index.html","content":"逍遥博客大胆狂徒，敬畏万能的神兽吧！"},{"title":"分享","path":"/wiki/index.html","content":"一个舒服的写作环境打造一个舒服的写作环境 Chat GPT Web账号需要审核哦！"}]